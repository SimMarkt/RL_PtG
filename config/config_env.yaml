# ----------------------------------------------------------------------------------------------------------------
# RL_PtG: Deep Reinforcement Learning for Power-to-Gas dispatch optimization
# https://github.com/SimMarkt/RL_PtG

# config_env: 
# > Configuration file for the PtG environment, covering three different economic business scenarios.
# > Scenario 1 - Involves trading in the electricity, gas, and emission spot markets.  
# > Scenario 2 - Features a fixed synthetic natural gas (SNG) price while trading in the electricity and emission spot markets.  
# > Scenario 3 - Includes participation in EEG tenders using a combined heat and power (CHP) plant while trading in the electricity spot market.  
# ----------------------------------------------------------------------------------------------------------------

# Abbreviations:
#   SNG: Synthetic natural gas
#   EUA: European emission allowances
#   CHP: Combined heat and power plant
#   CH4: Methane
#   H2: Hydrogen
#   O2: Oxygen
#   CO2: Carbon dioxide
#   H2O_DE: Water steam
#   LHV: Lower heating value
#   EEG: German renewable energy act

scenario : 1                    # Business case, must match [1,2,3]
operation : OP1                 # Specifies the load level "OP1" or "OP2" of the PtG-CH4 plant
price_ahead : 13                # No. of forecast values for electricity price future data (0-12h)
time_step_op : 2                # Time step between consecutive entries in the methanation operation data sets in [s]
noise : 10                      # Noise factor affecting state transitions in the methanation process in the gym environment [No. of steps in operation data set]
eps_len_d : 37                  # No. of days in an episode (episodes are randomly selected from the entire training data set without replacement)
state_change_penalty : 0.0      # Factor enabling reward penalty during training (if state_change_penalty = 0.0: No reward penalty; if state_change_penalty > 0.0: Reward penalty on mode transitions;)
sim_step : 600                  # Frequency for taking an action in [s]
raw_modified : mod              # Specifies the type of state design using raw energy market prices ('raw') or modified economic metrices ('mod')

# File paths to energy spot market data for training and evaluation:
# (_train: training set; _val: validation set; _test: test set)
# _el: electricity spot market data in [hours]
datafile_path_train_el : /data/spot_market_data/data-day-ahead-el-train.csv
datafile_path_val_el : /data/spot_market_data/data-day-ahead-el-val.csv
datafile_path_test_el : /data/spot_market_data/data-day-ahead-el-test.csv
# _gas: natural gas/SNG spot market data in [days]
datafile_path_train_gas : /data/spot_market_data/data-day-ahead-gas-train.csv
datafile_path_val_gas : /data/spot_market_data/data-day-ahead-gas-val.csv
datafile_path_test_gas : /data/spot_market_data/data-day-ahead-gas-test.csv
# _eua: European emission allowances (EUA) spot market data in [days]
datafile_path_train_eua : /data/spot_market_data/data-day-ahead-eua-train.csv
datafile_path_val_eua : /data/spot_market_data/data-day-ahead-eua-val.csv
datafile_path_test_eua : /data/spot_market_data/data-day-ahead-eua-test.csv

# File paths to process data for the dynamic data-based process model of the methanation plant:
# Process data of the load levels OP1 and OP2
datafile_path :
    path : data/
    datafile:   # Dynamic process data
        datafile_path2 : data-meth_startup_cold.csv  # cold startup
        datafile_path3 : data-meth_startup_hot.csv   # warm startup
        datafile_path4 : data-meth_cooldown.csv      # cooldown
        datafile_path5 : data-meth_standby_down.csv  # from operation to standby
        datafile_path6 : data-meth_standby_up.csv    # from idle state to standby
        datafile_path7 : data-meth_op1_start_p.csv   # entering partial load after startup
        datafile_path8 : data-meth_op2_start_f.csv   # entering full load after startup
        datafile_path9 : data-meth_op3_p_f.csv       # load change from partial to full load
        datafile_path10 : data-meth_op4_p_f_p_5.csv  # load change from partial to full load and back to partial load after 5 min
        datafile_path11 : data-meth_op5_p_f_p_10.csv # load change from partial to full load and back to partial load after 10 min
        datafile_path12 : data-meth_op6_p_f_p_15.csv # load change from partial to full load and back to partial load after 15 min
        datafile_path13 : data-meth_op7_p_f_p_20.csv # load change from partial to full load and back to partial load after 20 min
        datafile_path14 : data-meth_op8_f_p.csv        # load change from full to partial load
        datafile_path15 : data-meth_op9_f_p_f_5.csv    # load change from full to partial load and back to full load after 5 min
        datafile_path16 : data-meth_op10_f_p_f_10.csv  # load change from full to partial load and back to full load after 10 min
        datafile_path17 : data-meth_op11_f_p_f_15.csv  # load change from full to partial load and back to full load after 15 min
        datafile_path18 : data-meth_op12_f_p_f_20.csv  # load change from full to partial load and back to full load after 20 min  

# Control and inner state spaces of the PtG-CH4 system (aligned with the programmable logic controller of the real-world plant)
ptg_state_space:
  standby : 0
  cooldown : 1
  startup : 2
  partial_load : 3
  full_load : 4

# Methanation data for steady-state operation for the different load levels
meth_stats_load : 
    OP1 :  # [off, partial_load, full_load] : [-, -, -]
        Meth_State : [2, 5, 5]                          # Addresses the inner state spaces of the Power-to-Gas System
        Meth_Action : [6, 10, 11]                       # Addresses the action spaces of the Power-to-Gas System
        Meth_Hot_Cold : [0, 1, 1]                       # Hot [=1] or Cold [=0] methanation reactor
        Meth_T_cat : [11.0, 451.0, 451.0]               # Maximum catalyst temperature in the methanation reactor system [°C]
        Meth_H2_flow : [0.0, 0.00701, 0.0198]           # Hydrogen reactant gas molar flow [mol/s]
        Meth_CH4_flow : [0.0, 0.00172, 0.0048]          # Methane product gas molar flow [mol/s]
        Meth_H2_res_flow : [0.0, 0.000054, 0.000151]    # Hydrogen product gas molar flow (residues) [mol/s]
        Meth_H2O_flow : [0.0, 0.0624, 0.458545]         # Water mass flow [kg/h]
        Meth_el_heating : [0.0, 231.0, 350.0]           # Electrical power consumption for methanation heating [W]
    OP2 :
        Meth_State : [2, 5, 5]                          # Addresses the inner state spaces of the Power-to-Gas System
        Meth_Action : [6, 10, 11]                       # Addresses the action spaces of the Power-to-Gas System
        Meth_Hot_Cold : [0, 1, 1]                       # Hot [=1] or Cold [=0] methanation reactor
        Meth_T_cat : [11.0, 451.0, 451.0]               # Maximum catalyst temperature in the methanation reactor system [°C]
        Meth_H2_flow : [0.0, 0.0198, 0.0485]            # Hydrogen reactant molar flow [mol/s]
        Meth_CH4_flow : [0.0, 0.0048, 0.0114]           # Methane product molar flow [mol/s]
        Meth_H2_res_flow : [0.0, 0.000151, 0.0017]      # Hydrogen product molar flow (residues) [mol/s]
        Meth_H2O_flow : [0.0, 0.458545, 1.22]           # Water mass flow [kg/h]
        Meth_el_heating : [0.0, 350.0, 380.0]           # Electrical power consumption for methanation heating [W]

# Economic data and parameters
ch4_price_fix : 15.0               # Fixed SNG price in business case/ scenario 2 in [ct/kWh]
heat_price : 4.6                   # Heat price in [ct/kWh]
o2_price : 10.2                    # O2 price in [ct/Nm³]
water_price : 6.4                  # Water price in [ct/m³]
eeg_el_price : 17.84               # EEG tender price in business case/ scenario 3 in [ct/kWh_el]
# Species properties and efficiencies
H_u_CH4 : 35.883                   # Lower heating value of methane in [MJ/m³]
H_u_H2 : 10.783                    # Lower heating value of hydrogen in [MJ/m³]
h_H2O_evap : 2257                  # Specific enthalpy of vaporization in [kJ/kg] (at 0.1 MPa)
dt_water : 90                      # Tempature difference between cooling water and evaporation in [K]
cp_water : 4.18                    # Specific heat capacity of water in [kJ/kgK]
rho_water : 998                    # Densitiy of water in [kg/m³]
convert_mol_to_Nm3 : 0.02241407    # Factor for converting moles to Nm³ for an ideal gas at normal conditions in [Nm³/mol] (convert_mol_to_Nm3 : R_uni * T_0 / p_0 = 8.3145J/mol/K * 273.15K / 101325Pa = 0.02241407 Nm3/mol)
Molar_mass_CO2 : 44.01             # Molar mass of carbon dioxid in [g/mol]
Molar_mass_H2O : 18.02             # Molar mass of water in [g/mol]
min_load_electrolyzer : 0.032      # Minimum electrolyzer load = 3.2% (According to static data-based regression model of PEMEL)
eta_CHP : 0.38                     # Gas engine/ CHP efficiency

# Optional: The model can implements reward penalties for state transitions
r_0_values :   # Reward level price values -> Set the general height of the reward penalty according to electricity, (S)NG, and EUA price levels
    el_price : [0]
    gas_price : [10]
    eua_price : [50]

# Threshold values for methanation data
t_cat_standby : 188.2              # Catalyst temperature threshold for changing standby data set in [°C] (If the plant goes to standby from idle state and reaches T_Cat > t_cat_standby, the model uses "data-meth_startup_hot.csv" for the next startup)
t_cat_startup_cold : 160           # Catalyst temperature threshold for cold start conditions in [°C] (For T_Cat < t_cat_startup_cold, the model uses "data-meth_startup_cold.csv" for the next startup)
t_cat_startup_hot : 350            # Catalyst temperature threshold for hot start conditions in [°C] (For T_Cat > t_cat_startup_hot, the model uses "data-meth_startup_hot.csv" for the next startup)
# Time threshold for load change data set, from time = 0 (Important to identify the data set with the most suitable mode transition)
time1_start_p_f : 1201             # Simulation step -> 2400 sec
time2_start_f_p : 151              # Simulation step -> 300 sec
time_p_f : 210                     # Simulation steps for load change (asc) -> 420 sec
time_f_p : 126                     # Simulation steps for load change (des) -> 252 sec
time1_p_f_p : 51                   # Simulation step -> 100 sec
time2_p_f_p : 151                  # Simulation step -> 300 sec
time23_p_f_p : 225                 # Simulation step inbetween time2_p_f_p and time3_p_f_p
time3_p_f_p : 301                  # Simulation step -> 600 sec
time34_p_f_p : 376                 # Simulation step inbetween time3_p_f_p and time4_p_f_p
time4_p_f_p : 451                  # Simulation step -> 900 sec
time45_p_f_p : 563                 # Simulation step inbetween time4_p_f_p and time5_p_f_p
time5_p_f_p : 675                  # Simulation step -> 1348 sec
time1_f_p_f : 51                   # Simulation step -> 100 sec
time2_f_p_f : 151                  # Simulation step -> 300 sec
time23_f_p_f : 225                 # Simulation step inbetween time2_f_p_f and time3_f_p_f
time3_f_p_f : 301                  # Simulation step -> 600 sec
time34_f_p_f : 376                 # Simulation step inbetween time3_f_p_f and time4_f_p_f
time4_f_p_f : 451                  # Simulation step -> 900 sec
time45_f_p_f : 526                 # Simulation step inbetween time4_f_p_f and time5_f_p_f
time5_f_p_f : 601                  # Simulation step -> 1200 sec
# Simulation steps for fully developed partial / full load transition
i_fully_developed : 12000          # Simulation step -> 24000 sec (initial value)
j_fully_developed : 100            # Simulation step -> 24000 sec (step marker)

# Lower and upper bounds for normalizing PtG environment (Should be adjusted to the energy market and process data value ranges)
el_l_b : -10    # Lower bound of electricity prices in [ct/kWh_el]
el_u_b : 90     # Upper bound of electricity prices in [ct/kWh_el]
gas_l_b : 0.4   # Lower bound of (S)NG prices in [ct/kWh_th]
gas_u_b : 32    # Upper bound of (S)NG prices in [ct/kWh_th]
eua_l_b : 23    # Lower bound of EUA prices in [€/t_CO2]
eua_u_b : 98    # Upper bound of EUA prices in [€/t_CO2]
T_l_b : 10      # Lower bound of catalyst temperatures T_CAT in [°C]
T_u_b : 600     # Upper bound of catalyst temperatures T_CAT in [°C]
h2_l_b : 0      # Lower bound of hydrogen molar flow in [mol/s]
ch4_l_b : 0     # Lower bound of methane molar flow in [mol/s]
h2_res_l_b : 0  # Lower bound of residual product gas hydrogen molar flow in [mol/s]
h2o_l_b : 0     # Lower bound of water mass flow in [kg/h]
# The upper bounds for hydrogen (h2_u_b), methane (ch4_u_b), residual hydrogen (h2_res_u_b), and water (h2o_u_b)
# correspond to the full_load values from meth_stats_load for the selected load level.
heat_l_b : 0    # Lower bound of the power consumption of methanation in [W]
heat_u_b : 1800 # Upper bound of the power consumption of methanation in [W]